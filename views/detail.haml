%section{:id => "main"}
- if @data.length > 0
  .container
    .content
      .row
        .span9
          - image_file = '/data/chart_' + @params[:code] + '.png'
          %img{:src => image_file}

          - row = @data.last

          %table.table.table-striped
            %thead
              %tr
                %th SMA5
                %th SMA25
                %th SMA75
                %th EWMA5
                %th EWMA25
                %th EWMA75
                %th UPPER
                %th MIDDLE
                %th LOWER
                %th RET
            %tbody
              %tr
                %td
                  =h row[:sma5].to_f.round(2)
                %td
                  =h row[:sma25].to_f.round(2)
                %td
                  =h row[:sma75].to_f.round(2)
                %td
                  =h row[:ewma5].to_f.round(2)
                %td
                  =h row[:ewma25].to_f.round(2)
                %td
                  =h row[:ewma75].to_f.round(2)
                %td
                  =h row[:upperband].to_f.round(2)
                %td
                  =h row[:middleband].to_f.round(2)
                %td
                  =h row[:lowerband].to_f.round(2)
                %td
                  =h row[:ret_index].to_f.round(2)

          %table.table.table-striped
            %thead
              %tr
                %th RSI9
                %th RSI14
                %th MFI
                %th ROC
                %th CCI
                %th ULT
                %th SLOWK
                %th SLOWD
                %th FASTK
                %th FASTD
                %th MACD
                %th SIGNAL
                %th HIST
                %th MOM10
                %th MOM25
                %th NATR
            %tbody
              %tr
                %td
                  =h row[:rsi9].to_f.round(2)
                %td
                  =h row[:rsi14].to_f.round(2)
                %td
                  =h row[:mfi].to_f.round(2)
                %td
                  =h row[:roc].to_f.round(2)
                %td
                  =h row[:cci].to_f.round(2)
                %td
                  =h row[:ultosc].to_f.round(2)
                %td
                  =h row[:slowk].to_f.round(2)
                %td
                  =h row[:slowd].to_f.round(2)
                %td
                  =h row[:fastk].to_f.round(2)
                %td
                  =h row[:fastd].to_f.round(2)
                %td
                  =h row[:macd].to_f.round(2)
                %td
                  =h row[:macdsignal].to_f.round(2)
                %td
                  =h row[:macdhist].to_f.round(2)
                %td
                  =h row[:mom10].to_f.round(2)
                %td
                  =h row[:mom25].to_f.round(2)
                %td
                  =h row[:natr].to_f.round(2)

        .span3
          %table.table.table-striped
            %thead
              %tr
                %th 日付
                %th 始値
                %th 高値
                %th 安値
                %th 終値
                %th 出来高
            %tbody
              - limit = @data.length - 15
              - @data.each_with_index do |row, i|
                - if i >= limit
                  - date  = row[:date]
                  - open  = row[:open].to_i
                  - high  = row[:high].to_i
                  - low   = row[:low].to_i
                  - close = row[:adj_close].to_i
                  - volume = row[:volume].to_i
                  - unless date == "Date"
                    %tr
                      %td
                        =h date
                      %td
                        =h open
                      %td
                        =h high
                      %td
                        =h low
                      %td
                        =h close
                      %td
                        =h volume
